<head><meta charset="UTF-8"><title>Aiwana save the sunkist!</title></head>
<body style="background-color:#d6cabe;">
<div style="text-align:center;">
<h1>Aiwana save the sunkist!</h1>
engine by renex, major modifications and levels by Maximus Miller 2<br>
controls: arrow keys, space, shift, z, p, f, b, f2, m, k
<h2 id="timer"></h2>
<canvas id="canvas" width="800" height="608" style="display:inline-block;width:800px;aspect-ratio:800/608;cursor:crosshair;"></canvas>
<br>
<span id="footer"></span>
<script>
var canvas = document.getElementById('canvas'),
    con2d = canvas.getContext('2d');
    // let dpr = window.devicePixelRatio || 1;
    // canvas.width = 800 * dpr;
    // canvas.height = 608 * dpr;
    // con2d.scale(dpr, dpr);
    if( localStorage.muted == undefined ) localStorage.muted = false;
    if( localStorage.worldData == undefined ) localStorage.worldData = "{}";
    con2d.imageSmoothingEnabled = false;
    function resizeCanvas() {
        // let scale = Math.min(
        //   window.innerWidth / canvas.width,
        //   window.innerHeight / canvas.height
        // );
        // if (true) {
        //   scale = Math.floor(scale);
        // }
        // canvas.style.width = `${Math.round(scale * canvas.width)}px`;
        // canvas.style.height = `${Math.round(scale * canvas.height)}px`;
      }

      resizeCanvas();
      window.addEventListener("resize", resizeCanvas);
var timer = document.getElementById("timer");
var footer = document.getElementById("footer");
var finished = 0,
    deaths = 0,
    time = 0;
var vkUp = 0,
    vkZ = 0,
    vkLeft = 0,
    vkRight = 0,
    vkRawZ = 0,
    vkRawUp = 0,
    vkRawLeft = 0,
    vkRawRight = 0,
    vkGamepadSupport = "getGamepads" in navigator,
    vkGamepad = 0;
var degtorad = Math.PI / 180;
var started = 0;


if (console.everything === undefined) {
    console.everything = [];
    function TS(){
      return (new Date).toLocaleString("sv", { timeZone: 'UTC' }) + "Z"
    }
    window.onerror = function (error, url, line) {
      console.everything.push({
        type: "exception",
        timeStamp: TS(),
        value: { error, url, line }
      })
      return false;
    }
    window.onunhandledrejection = function (e) {
      console.everything.push({
        type: "promiseRejection",
        timeStamp: TS(),
        value: e.reason
      })
    } 
  
    function hookLogType(logType) {
      const original= console[logType].bind(console)
      return function(){
        // console.everything.push({ 
        //   type: logType, 
        //   timeStamp: TS(), 
        //   value: Array.from(arguments) 
        // })
        console.everything.push(Array.from(arguments))
        original.apply(console, arguments)
      }
    }
  
    ['log', 'error', 'warn', 'debug'].forEach(logType=>{
      console[logType] = hookLogType(logType)
    })
}  

window.stdlog = window.alert.bind(window);
window.logs = [];
window.alert = function(){
    window.logs.push(Array.from(arguments).join("|"));
    window.stdlog.apply(window, arguments);
}

// Source - https://stackoverflow.com/a
// Posted by Otto Allmendinger, modified by community. See post 'Timeline' for change history
// Retrieved 2025-11-13, License - CC BY-SA 4.0

/**
 * Returns a number whose value is limited to the given range.
 *
 * Example: limit the output of this computation to between 0 and 255
 * (x * 255).clamp(0, 255)
 *
 * @param {Number} min The lower boundary of the output range
 * @param {Number} max The upper boundary of the output range
 * @returns A number in the range [min, max]
 * @type Number
 */
Number.prototype.clamp = function(min, max) {
  return Math.min(Math.max(this, min), max);
};


document.addEventListener("keyup",(ev)=>{
    if(ev.key == "`"){
      window.stdlog("Console: \n" + JSON.stringify(console.everything) + "\n Alerts: \n" + JSON.stringify(window.logs));
    }
    if(ev.key == "~"){
      let input = prompt('>');
      window.stdlog(eval(input));
      // if(sv_cheats == 1) {$("#peppino").show()};
    }
})


var showTriggers = false;
var motionblur = false;
var color = "#d6cabe";

function intersectRect(r1, r2, offx, offy) {
    return !(r2.x >= r1.x + r1.width + offx || r2.x + r2.width <= r1.x + offx || r2.y >= r1.y + r1.height + offy || r2.y + r2.height <= r1.y + offy);
}

function loadSprite(data) {
    var spr = new Image();
    spr.src = "data:image/png;base64," + data;
    return spr;
}
function loadLocalSprite(data) {
    var spr = new Image();
    spr.src = data;
    return spr;
}

function loadAudio(data) {
    var snd = new Audio("data:audio/mpeg;base64," + data);
    document.body.appendChild(snd);
    return snd;
}
function loadLocalAudio(data) {
    var snd = new Audio(data);
    document.body.appendChild(snd);
    return snd;
}

function playSound(snd) {
    snd.currentTime = 0;
    snd.play();
}

function sprite(img, x, y) {
    con2d.drawImage(img, Math.floor(x), Math.floor(y));
}

function sprite_ext(img, u, v, w, h, x, y, ww = false, hh = false) {
    ww=ww?ww:w
    hh=hh?hh:h
    con2d.drawImage(img, u, v, w, h, Math.floor(x), Math.floor(y), ww, hh);
}

var sprPlayerIdle = loadSprite("iVBORw0KGgoAAAANSUhEUgAAAIAAAAAgCAYAAADaInAlAAACH0lEQVR4nO2WTU7DQAyFK0Wq2ILEhgtwDCS2uQE34Cbd9SA5CMcamIipJo7t+bUnav0kCwRpP783T6OcTiaTyWQymUwmk8lkMplMJpPJZHpEOefYefp7JDXY53qwJfk5bGn/h1CO+a/3F3IkCyDJLzn8Uf5VCthinguhNQBpfo/Dl/SvUUB2CQzsfq67kSyAJD8n/NH+pQtILoHBg+EVBn72DkCDXxq+pn+tApJLcHAsgNorqMZ8L35t+Fr+NQpILkHBsdEogAS/pACj/UsVMLlEWCRu2ubtUygADT7HHu1fq4DsEgswioUgWQBpfqoAR/EvWUByiYWAYe3zM03TbloC0ODnHv4R/EsVEF0ihj+/XdfB2hdPzwC0+DnhH8m/RAF3S3j4Qpj3vwcwFUrLFRizNfhY8ND7CP9c/r0LuFkiBYeDXU+1AeSY782/nM8u5pawj+S/pYC3JeACsSkuAHgVlS6AHQD8Tim+fyYuQfg+GK6m/9L8Wwu4CguBeuvkpuYlxLMDv4Vdww/PeT7G/vj/u5b/mgxaC3hbAi4AQ3j9/N4NZrrmCowLEI9nS/LDc1iYga3pvyb/1gKuCi28gMbHAcAlKGhtAHDgAUjw42cx3yP8a+e/CQILHy7BNa42ADiQDQ+oF5/6nBZ/tH92iRQsZ5lathafC+8R/JNLpF5yer4E5ZiX4ueGf6/+ySXmeXbY5P6/NQAtPlWAe/b/C97fIhbuV2oAAAAAAElFTkSuQmCC");
var sprPlayerRun = loadSprite("iVBORw0KGgoAAAANSUhEUgAAAMAAAAAgCAYAAABEmHeFAAACYElEQVR4nO2YTWrDMBCFA4HQbQvd9AI9RqHb3KA36E26y0FykB7LjQMqymQkPVkaKZbfg6GF2v7e/Fmmux1FURRFURRFURRFURRFURRFURRFURRFUdSYmqYJjqfL5anQ7iOffERd+LnJf72/BMOyAeSPyUe9mPFrJR8zQT75iLrw0QJI0PR7ugvLBpA/Jh/xYspfsv0OeIWJn7UbQP7Y/JQXc37J9msGtGeQTz6iLvzcAmhHz40h4waQPxY/5cWcnyqAM+GM+EfNzb+fjBpA/th8xIspHynAWYA0E5YNIH9cPuLFlJ+TvDQhj5859vv9XayZH3rbbCV/a37KizkfTf757XQNbSD8qNGAmevCmu84odwdF2GvMf/e/Y95acKPFV8OgW/GbV7IFHoE/RwO/wOosSXf/V6bH8tbskfKv3f/Q16a8UMDEIPLkEdTbgM0D7HmW/NDb51W/Jb59+6/rAUy/FX5oQaclYfGGiC/xUoHUPu+a8HXnvVx+ftW8m/df+mlOd9dNBchNQhoyGM1l1/CLuVL9jz8LraQf+v+++rC9y90RfAHQb4FXz+/70KDLvkGlXw/WvJ9plyALeTfsv++tAUw54duim2YhNdqgGyGNoA+P7X5JfxYTXrkH+qBFV8un1X9fYVeACF+jfwXLQCStMUAIr5a81vk36P+2gsI+QwsWQCfjfJL8w/edDweJy0eZQFC/mrzkXxLvkGRnJFerLX+iJdYfYsXcEnyuUuwVj7CQ66plf/SOjxy/VNeYkzUT7UC5Gy9RQNa8xEeck2t/JfW4ZHrn/ISY6J+pP4AzU33Z6sKRXQAAAAASUVORK5CYII");
var sprPlayerJump = loadSprite("iVBORw0KGgoAAAANSUhEUgAAAEAAAAAgCAYAAACinX6EAAABQklEQVR4nO2WXwrCMAyHhcHwVcEXL+AxBF93A2/gaXaQHcRjVTspZFnSKssfHxIIGwX5fn60WXe7qKioqKioqKiodaWUVr1/L7ca/0Yygymfg98vR7Y1BZjzf4VzISQEuPCxAAxKz/EDA09NAeb8mv0MowJQ53CrADd+yz7VGjPAjc8J4OBWAsz43BCEW23x+UEBuq5LubcKcONDARMCUSHKWgFLCnDh1y4g3PbDAaQ/g6Z8DD+cx7lbNzEIl/wKmPPh1sPw/F7Mc6EkBLjy4bmDAco7bOp8Sghw5ePB0wqAz6KkABf+N5OXa6l7gCufE3C6PVaNoZoCzPhZwMQYxnAtAa78IuDa94uubTcNAW58CKcuRcMwzOv5WQuzpfCfhwLU+UUAdyOkAlAhJAS48CmbHgLc+P8gwJXPDRXLGaDNfwGskmKr9cqDRQAAAABJRU5ErkJggg");
var sprPlayerFall = loadSprite("iVBORw0KGgoAAAANSUhEUgAAAEAAAAAgCAYAAACinX6EAAABYUlEQVR4nO2WzQ3CMAxGK1VCXEHiwgKMUYlrN2ADNuHWQToIY4WmwpLlxvlpYnPAliygSvq+PpK2XWdlZWVlZWVlZWVl9dflnMvu4zI81aF5rTKI8Evhj9uZbUkBYvxW8FiIWgGi/FwBFOTe06YlBYjx99gPwX1z+7BGgDi/xv4Ko5+N7wHi/FIB1Li2gOb83HsABOGWX42AeZk3M3PF+TkCZvycJfsNH68VwEkQ5ZdcPIWFfvd9v+mUgNfh4LAELEKcz100NJz4dJ3WTr2JtRKgxgc4vXAODt9hKXKhSrYAJ0CF7weEAsTgtEP7s1QAzaDGDwnAJ8P7KxYg9jKSKppBlQ+D8L8Qu9vm9N73gJ/w8UCQ4JuedPgeu9yfm+YeP6UCcAY1furlA+ADCkXhOEDonygRoM7nBIzjGFxWseWGj/v5NQLU+LGlg0PExtEAGL5XgBo/dVIIkRuAwmsESPI/MghweUua31QAAAAASUVORK5CYII");
var sprBlood = loadSprite("iVBORw0KGgoAAAANSUhEUgAAAAwAAAAECAYAAAC6Jt6KAAAAGUlEQVR4nGNgIAf8B6L/YApVDB+fZAOJBgDOLgv1DBMpZwAAAABJRU5ErkJggg");
var sprBullet = loadSprite("iVBORw0KGgoAAAANSUhEUgAAAAgAAAAECAYAAACzzX7wAAAAJklEQVR4nGNgAAOO/xAMAyh8jv////8DY5jE+8cMYAxVRFABfisATukroSL2lR8AAAAASUVORK5CYII");
var sprWarp = loadLocalSprite("assets/sprites/warp.png")//loadSprite("iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAA4UlEQVR4nOXXUQ6EIAwEUDgut+QMXGg3+8GmITCdDm7ELEm/VPpUbDHlnF93RjoWUEr5hnJcBtiJx2CObwHQ5JH4KaDWOg0Vktjkq8S7CBdgE7TWlrGCXAZAyXcQcA2wdz9DPBOAEGOiPrxXEC5EI2QErAZ6AghyOSCKoAGf8MYxgAgCtuNxMT4GgMpzCNARfRHuPgFpDVgA+xVYhARARSgK6IhQHWCaEEq8eg2hUqz2gNsBaKMiAWZhE3s7J6kXeJOx2ze5GXkJmNoh7wcYhAew13vnUZWQSajGuf+GfwN4AyIF8R308bLtAAAAAElFTkSuQmCC");
var sprWall = loadSprite("iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAADXSURBVEhL7ZRBDoJADEXZuPIEsvAQLvEmXshwHi9oScnP5LdoC8WwcPJW/W0fEDLd9Xzalf0F49ALr8ftA+2A9sfJCZ73CyaDOAJkANsLBAhaygSoEiqgYpDfCpYclQLXUSywHF6ARd3C2STA9q8CaaDhCAmBOrLkBCscznU9VZtDaRZfAAdFK5h/UyAlK6CeFPsLdEUcmlfkgagNFAj0jakN8CdyaQcoEqygTUMCwR1WSEBpVCBEBBQJf4FQLNB1lsMLdF7QK8SeTQJsF+Z95mhKg+PQvwESm8qFX3hZ6QAAAABJRU5ErkJggg");
var sprWall2 = loadSprite("iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAARBJREFUSEvtlD0KAjEQheMfFloJFm5haylYyXoMOwvP4C1kb+A9vKBvecuYTAImmywoOHwu4U0mn5tizeC1nI6vu5VPqdzg5/eYFMnNbb8G88mIC67RK5Wbpq4IrutxPuKJVML8/C1gT+0mdn4/bYK5jZ07b4AUT/glzM87AVNZy0x+3grs1OmVyNtCiraiYP7rhZt6Xg6ki7zaLmbAvtx4jJz+UYANajiGBAEdqaQJejicYdKmVqluKmGBOFSrB87HDiDyBWpPEsMLeEQ8ap7gD6ltQgEB31htE/QVBbEHVAv4ArsbJQDBYaIEqhsrADEC1QJ/ASgs4HE+Xy/gPOAnxK8sgZwOuvO8YlcNNnX1Ajr4W+yp3ghHAAAAAElFTkSuQmCC");
var sprWall3 = loadSprite("iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABuklEQVR4AeyWMY6CQBSG/9kzeAZjYmnjESy8gQ2tiZUXsPMEXsHEA1jY2dqoiZWtFBRwASAh7P7P4LIzBEYScAuKP755zPvfNwMm7wtA+kkRAIPBoHUNh8OfcwMCwGi73aINjcdjUOxJvQC4+IQMgCAIsFqtMBqNRIyZqyPW6j76IQ2AzWaD/X4Pz/PweDwkZk4vrFqzxsbHAGCR67qI4xhRFOF4PApEVUP9ua2PAUCjMAzh+z4ulwuu1ytTtWTjYwBMp1P0+32cz2fcbjcsl0sw9y4Ba2x8DIDFYiEN5/M51uu1xMy9C8AaQlT5GABsxOLD4QCKMXN1xFp6UIyLPAoBijY2lesAuhuQG1BKNfWNVfoKQJpyJqnc28gGAWjE2dK0A/gfN6DU338Bh4nJZAKKseXrNLaxlh4U4/yG7MOXG8gW3MCNHCaanoiUeh5aANg4E5u3PhEp9aTJIGwmmWxv2a+Nj9xA/hVwiLCZZMoa85mtjwAo9XsDHBxYXDXJsEmZbH0EIH8Du90OvV4PjuOIGDNXR6x1NB8dWgD0ZJvrF8BsNgN1Op3QhpIkkXMKwP1+R1Mq8yXBNwAAAP//QRxF0AAAAAZJREFUAwC1H0g/BXLZuwAAAABJRU5ErkJgggAA");
var sprSpikeUp = loadSprite("iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAq0lEQVR4nNXXvRHAIAiAUcrs37iOSziFQ5ij8M4Y/AH1hIJSv9eJAN6DdB6AhLNyh/zgbQCGY4wphLCGMAko43nECHMAKr6EMAXoxcUIM4AcHwGcczyECUAZnwGwEOoBdXwWMI1QDaDiHMAUQi2gFecChgiVgF5cAugi1AHKB2cnoIlQBaif290AEqEGQC0bJwA/hApAa9U6BfggrgN6i+ZJAA4gIv9wbwwCXtFLHNaPQbp0AAAAAElFTkSuQmCC");
var sprSpikeDown = loadSprite("iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAoklEQVR4nNXOuw3AMAhFUcrs33gdL+EpPER+kiMnAZtPpEDxqJDugQVg/XNwnJQSe6UUcrVWdNTvCYCcRYgvAFd8b/sASBBWwC3uCsBFWACvuDsAB6EFoHGXgBlCAyDjbgEjhAZAxl0DKIQUMIy7B2AICWAaDwF4IrgAVjwMoEdwAOx4KEBDzACieDjACKGKhwRgCHU8LKBHmOKhAQ1hinsAbC0sHOZ1jHh2AAAAAElFTkSuQmCC");
var sprSpikeLeft = loadSprite("iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAArElEQVR4nMXXwQ2AIAyF4R7d/8I6LMEUDKHRhERNQwpt3zv0/H+JokWkVmHMIXLeQwuXUrCAd3gMBKCFIYBZOBVgCacAVsKhgJ1wCMATdgEiwluAyPASICNsAoxway1tVAAirAKQ4Q+AEVYBvfdn4ID/I0BCpi8hAmI6hgOSMUsfIhogE+L6GdEAkZDQhYQG8Bzf1KXUAoGs5TMI9GKiQShXszeEejkNPwW7kAsfThzmLrfheQAAAABJRU5ErkJggg");
var sprSpikeRight = loadSprite("iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAApUlEQVR4nMXXuw3AIAwEUJfZv2EdlmAKhkgCkhskZIw/V1x9TwommIjoff5QrQTJKO+9TwQEMkpbaxMBgTCAkw5ZAemQHSANIgHCITwF2rhBbgFuECvADPECXEO8AWpIFOAYcjqGtxEh0QARkgXYQrIBHBgA9glgh/BoDEsp7lFdRJBib4DpZwQptgJcHySQYi0g9FEKKZYAqYsJpHgFQJdT5Hr+AWJ5HN5bh/GhAAAAAElFTkSuQmCC");
var sprPlatform = loadSprite("iVBORw0KGgoAAAANSUhEUgAAACAAAAAQCAYAAAB3AH1ZAAAAbUlEQVR4nGNgYGD4P8CY4b+WAvuA4AF1QHyg+cA5AGQ5Vgd4WqvSBQ9uByAHFUwDuUGNTT9RDgBJIrsYOd5gcsh8XOLo+okOAVwGUOoAdDWD0wEDnggH1AHYgpWWGMUB9LYcxQEDYTmKAwYSAwCgiwkgI2cRDQAAAABJRU5ErkJggg");
var sprSave = loadSprite("iVBORw0KGgoAAAANSUhEUgAAAEAAAAAgCAYAAACinX6EAAAB/ElEQVR4nOWVy1XDMBBFs6QPCH82FEEHKYNNemBPCCR8kjbSiu0cCmGFQQ5O5LHmJ8nSgsU7HuWc+L25Gsmjuq5H/1mdxdHvMoWwMDn8ewGKomhk/6Esy73MuqqqRnbdrrfbbc+w/W06nbIAUvs7A9imsG7FBTBPWxoAKf3ZAC76rl2wTSH9EABD+zsDQNrYDlABQiYgpT96BuEIwtGDdUwAKf3FZ7B9ui4gu45xCab0z/4Zyu3vDGFIcbvFyfc9qf2z70Bu/475d/2gkmZTzPuXs3G9Xl47IeTyVwXwnMZoAIbwdwagXoKPlTTAFQsgpb8oQMdoMmkEay5IG2DlAcB+//3XTSNY+/qzAXpN/4msqQCLSxUA2Ojd505UrfGXA+CaFgL48ATANS0FAP3JAHbzUgAYBB8AdvNSABgEMQDs7Om/tUiAlwsSQGp/NoB2AjZMgHclAO0E3K51/ukBPJ/nBQD8owLYZAZgmg8C4PpT7DNIAcjhzwbo3e6BE/A2P1MBgLd76ARAfzIAhEDVVPO+ACAEqqaaHwyA3bQUwOv8NBoAu2kpAOjPBoBnEWsaO3u9AE86ANAfa9rXXxTAFYS7dGICGNJfFSBEhwBjbwBD+HcCDC1jbkJgAHL4dwIsHo8RnRw022kp1nivNgQGIId/0h3ontn0E+Dy/wEvj7u8v9jBKQAAAABJRU5ErkJggg");
var sprBack = loadSprite("iVBORw0KGgoAAAANSUhEUgAAADAAAAANCAIAAABghHqjAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAGtJREFUSEtjCHO2TfJxLQz3ByIgA8iFsOmDMG0fdRAqGnUQITTqIEJoGDkIIkU2gluBhpClIFYQ5aDWtFigOBD52ZiTgSB6gYagGQtEQPHh4iAgCZQlG8ENQUNkOgiIgMZRiNAMhCB0251tAdyigrswkOXSAAAAAElFTkSuQmCC");
var sndJump = loadAudio("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");
var sndJump2 = loadAudio("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");
var sndShot = loadAudio("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CCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQuicc84555xzzjnnnHPOOeecc845JwDIt8IBwP/BxhlWks4KR4MLDVkJAIQDAAAKQSilYhBKKSWSTjopnZNQSimRg1JK6aSUUkoJpZRSSgillFJKCB2UUkIppZRSSimllFJKKaWUUjoppZRSSimllMo5KaWTUkoppUTOSSkhlFJKKaWEUkoppZRSSimllFJKKaWUUkoppYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhAIAuBscACASbJxhJemscDS40JCVAEBIAACgFHOOSggplJBSqJiijkIpKaRSSgoRY85J6hyFUFIoqYPKOQilpJRCKiF1zkEHJYWQUgkhlY466CiUUFIqJZTSOSilhBRKSimVkEJIqXSUUigllZRCKiGVUkpIJZUQSgqdpFRKCqmkVFIInXSQQiclpJJKCqmTlFIqJaWUSkoldFJCKimlEEJKqZQQSkgppU5SSamkFEIoIYWUUkolpZJKSiGVVEIJpaSUUiihpFRSSimlklIpAADgwAEAIMAIOsmosggbTbjwABQashIAIAMAQJR01mmnSSIIMUWZJw0pxiC1pCzDEFOSifEUY4w5KEZDDjHklBgXSgihg2I8JpVDylBRubfUOQXFFmN877EXAQAACAIABIQEABggKJgBAAYHCCMHAh0BBA5tAICBCJkJDAqhwUEmADxAREgFAIkJitKFLgghgnQRZPHAhRM3nrjhhA5tEAAAAAAAEADwAQCQUAAREdHMVVhcYGRobHB0eHyAhAQAAAAAAAgAfAAAJCJAREQ0cxUWFxgZGhscHR4fICEBAAAAAAAAAABAQEAAAAAAACAAAABAQE9nZ1MABGoaAAAAAAAARfQszgIAAAD+EcGqEWVfYHpucHKBX113bW5qb21gBL3W7hIVswxolIWRkdDJly9daAXBiCzO2kde4tX9/4vsx7D9F5H4k+TzNLpdLlfrHENtu/SH0fE4yP/+fxl3dzdS7fD//////ImHq6N0fHw+8zweU5/jSkLW3365uXaP/80KyghMR9OQFqBpmjpbO9j5zPi0suqLPhQ6uw5iam0h3Jc83cRo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");
var sndPain = loadAudio("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");
var sndChange = loadLocalAudio("assets/sounds/BlockChange.wav");
var sndDie = loadLocalAudio("assets/sounds/musOnDeath.ogg");
var sndDie = loadLocalAudio("assets/sounds/musOnDeath.ogg");
var sndFruit = loadLocalAudio("assets/sounds/19347_martian_chorused_bounces_06.wav");
var sndMusic = loadLocalAudio("assets/sounds/musGuyRock.ogg");
var sndTrap = loadLocalAudio("assets/sounds/sndSpikeTrap.wav");
var sndGlass = loadLocalAudio("assets/sounds/shatter.wav");
var sprWater = loadLocalSprite("assets/sprites/water2.png")
var sprJumper = loadLocalSprite("assets/sprites/jumper.png")
var sprJumpy = loadLocalSprite("assets/sprites/jumpy.png")
var sprJumpest = loadLocalSprite("assets/sprites/glass.png")
var sprKill = loadLocalSprite("assets/sprites/1.png")
var sprChecker = loadLocalSprite("assets/sprites/checker.png")
var sprChecker2 = loadLocalSprite("assets/sprites/checkerlight.png")
var sprConveyer = loadLocalSprite("assets/sprites/conveyer.png")
var sprConveyer2 = loadLocalSprite("assets/sprites/conveyer2.png")
var sprVineL = loadLocalSprite("assets/sprites/walljumpL.png")
var sprVineR = loadLocalSprite("assets/sprites/walljumpR.png")
var sprPanel = loadLocalSprite("assets/sprites/panel.png")
var sprPanel2 = loadLocalSprite("assets/sprites/sprBlock2.png")
var sprRestart = loadLocalSprite("assets/sprites/game-over.png")
var sprPauser = loadLocalSprite("assets/sprites/pauser.png")
var sprStick = loadLocalSprite("assets/sprites/sticky.png")
var sprHuh = loadLocalSprite("assets/sprites/huh.png")
var sprHuh2 = loadLocalSprite("assets/sprites/huh2.png")
var sprStars = loadLocalSprite("assets/sprites/bStars.png")
var sprMegaman = loadLocalSprite("assets/sprites/bMegaman.png")
var sprTree = loadLocalSprite("assets/sprites/bTree.png")
var sprFruit = loadLocalSprite("assets/sprites/fruit.png")
var sprFruit2 = loadLocalSprite("assets/sprites/fruit2.png")
var sprDirt = loadLocalSprite("assets/sprites/dirt.png")
var sprGrass = loadLocalSprite("assets/sprites/grass.png")
var sprLogos = loadLocalSprite("assets/sprites/logos.png")
var sprDarker = loadLocalSprite("assets/sprites/darker.png")
var sprDark = loadLocalSprite("assets/sprites/dark.png")
var sprDim = loadLocalSprite("assets/sprites/dim.png")





const MEGA = "assets/sounds/musMegaman.mp3";

// Source - https://stackoverflow.com/
// Posted by RafaÅ‚ S, modified by community. See post 'Timeline' for change history
// Retrieved 2025-11-07, License - CC BY-SA 3.0

function getMousePos(canvas, evt) {
    var rect = canvas.getBoundingClientRect();
    return {
        x: (evt.clientX - rect.left) / (rect.right - rect.left) * canvas.width,
        y: (evt.clientY - rect.top) / (rect.bottom - rect.top) * canvas.height
    };
}


canvas.addEventListener("mousedown", function(e){
    player.x = getMousePos(canvas, e).x
    player.y = getMousePos(canvas, e).y

})
let mcx, mcy;
canvas.addEventListener("mousemove", function(e){
    mcx = getMousePos(canvas, e).x
    mcy = getMousePos(canvas, e).y
})
let history = [];
let wallsLength = 0;
let fakeLength = 0;
let spikesLength = 0;
let platformsLength = 0;
let blockerLength = 0;
let curIndex = 0;
window.addEventListener("keydown", function(e) {
    if (e.defaultPrevented) return;
    if(level == 99){
        // alert("a")
        c = e.key
        cx = e.altKey?mcx:Math.floor(mcx/32) * 32
        cy = e.altKey?mcy:Math.floor(mcy/32) * 32
        if(c == ":") curIndex = Number(prompt("Trigger number?"))
        index = curIndex
        if (c == '#') walls.push(new Wall(cx, cy));
            if (c == '1') walls.push(new WallStick(cx, cy));
            if (c == 'e') walls.push(new Wall(cx-16, cy+00));
            // if (c == 'g') {walls.push(new Wall(cx-32, cy+00)); spikes.push(new SpikeRight(cx, cy, 5));}
            if (c == 'E') walls.push(new Wall(cx+16, cy+00));
            if (c == 'q') walls.push(new Wall(cx-00, cy+16));
            if (c == 'Q') walls.push(new Wall(cx+00, cy-16));

            if (c == '%') walls.push(new Wall2(cx, cy));
            if (c == '?') fake.push(new WallI(cx, cy, false));
            if (c == '!') walls.push(new WallI(cx, cy));

            if (c == '+') blocker.push(new WallI(cx, cy, true, false));

            if (c == 's') saves.push(new Save(cx, cy));
            if (c == '~') platforms.push(new Platform(cx, cy, 2, 0));
            if (c == '_') platforms.push(new Platform(cx, cy+16, 0, 0));
            if (c == '-') platforms.push(new Platform(cx, cy, 0, 1));
            if (c == '0') platforms.push(new Platform(cx, cy, 0, 2));

            if (c == '=') platforms.push(new Platform(cx, cy, 0, 0));

            if (c == '^') spikes.push(new SpikeUp(cx, cy));
            // if (c == 'z') {spikes.push(new SpikeUp(cx, cy+05)); fake.push(new WallI(cx, cy, false));}

            if (c == '6') spikes.push(new SpikeUp(cx, cy-16));
            if (c == '5') spikes.push(new SpikeUp(cx, cy+16));
            if (c == 'x'){ spikes.push(new SpikeUp(cx-16, cy));spikes.push(new SpikeDown(cx+1, cy));}
            if (c == 'X'){ spikes.push(new SpikeBlock(cx, cy));}
            if (c == '7'){ spikes.push(new SpikeDown(cx-16 , cy));}
            if (c == "'"){ spikes.push(new SpikeDown(cx+16 , cy));}

            if (c == '/'){ spikes.push(new SpikeUp(cx+16 , cy));}
            if (c == ')'){ spikes.push(new SpikeUp(cx+20 , cy));}

            if (c == '|'){ spikes.push(new SpikeUp(cx-16 , cy));}



            if (c == 'V') spikes.push(new SpikeDown(cx, cy));
            if (c == 'v') spikes.push(new SpikeDown(cx, cy-16));

            if (c == 'u') spikes.push(new SpikeDown(cx, cy, 2));
            if (c == 'U') {spikes.push(new SpikeDown(cx, cy-05));  fake.push(new WallI(cx, cy, false));}
            if (c == '&') {platforms.push(new Platform(cx, cy, 0, 0));  fake.push(new WallI(cx, cy, false));}


            if (c == '<') spikes.push(new SpikeLeft(cx, cy));
            if (c == '>') spikes.push(new SpikeRight(cx, cy));
            if (c == '{') spikes.push(new SpikeLeft(cx-16, cy));
            if (c == '}') spikes.push(new SpikeRight(cx+16, cy));
            if (c == '[') spikes.push(new SpikeLeft(cx+16, cy));
            if (c == ']') spikes.push(new SpikeRight(cx-16, cy));
            if (c == '.') spikes.push(new SpikeRight(cx, cy, 1));
            if (c == '@') spikes.push(new SpikeRight(cx, cy, Math.random()*3));



            if (c == 'b') blocker.push(new Blocker(cx, cy));
            if (c == 'w') warp = new Warp(cx, cy);
            if (c == 'W') fake.push(new Water(cx, cy));

            if (c == 'j') {fake.push(new Jumper(cx, cy, 15, sprJumpy)); blocker.push(new Blocker(cx, cy));}
            if (c == 'T') {fake.push(new Jumper(cx, cy+5, 15, sprJumpy)); fake.push(new WallI(cx, cy, false));}
            if (c == 'J') fake.push(new Jumper(cx, cy, 20, sprJumpest));

            if (c == 'c') walls.push(new Conveyer(cx, cy, 1));
            if (c == 'C') walls.push(new Conveyer(cx, cy, 4));

            if (c == 'd') walls.push(new Conveyer(cx, cy, -1));
            if (c == 'D') walls.push(new Conveyer(cx, cy, -4));

            // if (c == 'y') crates.push(new Crate(cx, cy, false, 25, 25));
            if (c == "H") platforms.push(new WallPlat(cx,cy,sprWall,1,0))
            if (c == "h") platforms.push(new WallPlat(cx,cy,sprWall,0,1))

            if (c == "o") platforms.push(new WallPlat(cx,cy,sprPauser,0,2))
            if (c == "O") platforms.push(new WallPlat(cx,cy,sprPauser,2,0))
            if (c == "8") platforms.push(new WallPlat(cx,cy,sprPauser,2,2))

            if (c == 'r') fake.push(new OneWayWall(cx, cy, false));
            if (c == 'R') fake.push(new OneWayWall(cx, cy, true));


            if (c == 'P') walls.push(new Poof(cx, cy));
            if (c == '$') walls.push(new Poof(cx, cy, 64, 64));
            if (c == 't') backgrounds.push(new Tree(cx, cy-135));

            
            if (c == 'a') spikes.push(new DeliciousFruit(cx, cy, 0, 10, index+1));
            if (c == '*') {fake.push(new Trigger(cx, cy, cx+cy));spikes.push(new DeliciousFruit(cx, 0, 0, 10, cx+cy));}
            if (c == 'â­™') spikes.push(new DeliciousFruit(cx, cy, 0, 0, 0));
            if (c == 'A') spikes.push(new DeliciousFruit(cx, cy, 10, 0, index+1));
            if (c == 'â†‘') spikes.push(new DeliciousFruit(cx, cy, 0, -10, index+1));
            if (c == 'â†') spikes.push(new DeliciousFruit(cx, cy, -10, 0, index+1));
            

            if (c == ';') fake.push(new Trigger(cx, cy, index+1));
            if (c == '"') backgrounds.push(new Text(cx,cy,prompt("Text?"), prompt("Color?", "black"), prompt("Font?", "bold 20px serif")))

            if (c == 'p') player = new Kid(cx, cy);

        if (walls.length != wallsLength) {wallsLength = walls.length;history.push(["walls",wallsLength])}
        if (spikes.length != spikesLength) {spikesLength = spikes.length;history.push(["spikes",spikesLength])}
        if (fake.length != fakeLength) {fakeLength = fake.length;history.push(["fake",fakeLength])}
        if (blocker.length != blockerLength) {blockerLength = blocker.length;history.push(["blocker",blockerLength])}
        if (platforms.length != platformsLength) {platformsLength = platforms.length;history.push(["platforms",platformsLength])}


        if (c == "Backspace") {
            if(!e.altKey){
                let findWall = walls.findIndex((e)=>{return e.x == cx && e.y == cy});
                if(findWall != -1) walls.splice(findWall,1); history.splice(history.findIndex((e)=>{return e[0]=="walls"&&e[1]==findWall}), 1)
                findWall = fake.findIndex((e)=>{return e.x == cx && e.y == cy});
                if(findWall != -1) fake.splice(findWall,1); history.splice(history.findIndex((e)=>{return e[0]=="fake"&&e[1]==findWall}), 1)
                findWall = platforms.findIndex((e)=>{return e.x == cx && e.y == cy});
                if(findWall != -1) platforms.splice(findWall,1); history.splice(history.findIndex((e)=>{return e[0]=="platforms"&&e[1]==findWall}), 1)
                findWall = spikes.findIndex((e)=>{return e.x == cx && e.y == cy});
                if(findWall != -1) spikes.splice(findWall,1); history.splice(history.findIndex((e)=>{return e[0]=="spikes"&&e[1]==findWall}), 1)
                findWall = blocker.findIndex((e)=>{return e.x == cx && e.y == cy});
                if(findWall != -1) blocker.splice(findWall,1); history.splice(history.findIndex((e)=>{return e[0]=="blocker"&&e[1]==findWall}), 1)
                findWall = saves.findIndex((e)=>{return e.x == cx && e.y == cy});
                if(findWall != -1) saves.splice(findWall,1)
            }else{
                let lastElement = history.pop();
                window[lastElement[0]].splice(lastElement[1]-1,1); 
            }
            
        }
    }
    switch (e.key) {
        case "F2":
            resetGame();
            break;
        case " ":   
            if (!started) startGame();
            vkRawUp = 1;
            vkUp = 1;
            break;
        case "z":
        case "Z":
            vkRawZ = 1;
            vkZ = 1;
            break;
        case "ArrowLeft":
            vkRawLeft = 1;
            vkLeft = 1;
            break;
        case "ArrowRight":
            vkRawRight = 1;
            vkRight = 1;
            break;
        case "Shift":
            if(level != 99) loadGame();
            break;
        case "r":
            loadGame();
            break;
        case "f":
            canvas.requestFullscreen();
            break;
        case "b":
            motionblur = !motionblur;
            break;
        case "m":
            localStorage.muted = !JSON.parse(localStorage.muted);
            sndMusic.volume = JSON.parse(localStorage.muted) ? 0 : 0.67;
            sndDie.volume = JSON.parse(localStorage.muted) ? 0 : 0.67;
            break;
        case "p":
            canvas.style.imageRendering = canvas.style.imageRendering == "pixelated" ? "auto" : "pixelated";
            resizeCanvas();
            break;
        case "k":
            player.kill();
            break;
        case "=":
            if(level != 99){
                levels[99] = "p w";
                level = 99;
                loadLevel(level);
                if(!started) startGame();

            }
            
            break;
        case "F1":
            if(level == 99){
                copyToClipboard(localStorage.worldData)
                alert("copied");
            }
            break;
        case "F3":
            if(level == 99){
                localStorage.worldData = prompt("paste");
                level = 99;
                startGame();
            }
            break;
        case "F4":
            showTriggers = !showTriggers;
            break;
        default:
            // player.kill();
            break;
    }
    
    e.preventDefault();
}, 1);

window.addEventListener("keyup", function(e) {
    if (e.defaultPrevented) return;
    switch (e.key) {
        case " ":
            vkRawUp = 0;
            break;
        case "z":
        case "Z":
            vkRawZ = 0;
            break;
        case "ArrowLeft":
            vkRawLeft = 0;
            break;
        case "ArrowRight":
            vkRawRight = 0;
            break;
        default:
            return;
    }
    e.preventDefault();
}, 1);
async function copyToClipboard(text) {
  try {
    await navigator.clipboard.writeText(text);
    console.log('Text copied to clipboard successfully!');
  } catch (err) {
    console.error('Failed to copy text: ', err);
  }
}
function readInput() {
    if (vkGamepad) {
        var gp = navigator.getGamepads();
        for (var i = 0; i < gp.length; ++i) {
            pad = gp[i];
            if (pad) {
                var ax = pad.axes[0];
                if (ax < -0.2) vkLeft = 1;
                if (ax > 0.2) vkRight = 1;
                if (pad.buttons[0].pressed) {
                    vkUp = 1;
                    if (!started) startGame();
                }
                if (pad.buttons[1].pressed) vkZ = 1;
                if (pad.buttons[2].pressed) loadGame();
            }
        }
    }
};

function clearInput() {
    if (!vkRawUp) vkUp = 0;
    if (!vkRawZ) vkZ = 0;
    if (!vkRawLeft) vkLeft = 0;
    if (!vkRawRight) vkRight = 0;
};
if (vkGamepadSupport) {
    window.addEventListener("gamepadconnected", function() {
        vkGamepad = 1;
        footer.innerHTML = "Gamepad detected";
    });
    window.addEventListener("gamepaddisconnected", function() {
        vkGamepad = 0;
        footer.innerHTML = "";
    });
    var chromeCheck = window.setInterval(function() {
        if (navigator.getGamepads()[0]) {
            vkGamepad = 1;
            window.clearInterval(chromeCheck);
        }
    }, 500);
}

function findWall(self, offx, offy, group = walls) {
    let a = false;
    if(group != walls){
        if(group == "just") group = walls;
        a = true;
    }
    let combinedGroup = group;
    if (!self.platform && !a){
        combinedGroup = group.concat(crates)
    }
    if(self.platform || (self.touchplat)){
        combinedGroup = combinedGroup.concat(platforms)
    }
    for (var i = 0, l = combinedGroup.length; i < l; i++) {
        coll = combinedGroup[i];
        if (intersectRect(self, coll, offx, offy) && coll != self) return coll;
    }
    return 0;
}
// search + shift + backspace -> insert mode
var levels = [
    "#########################" +
    "# #                     #" +
    "##     # #       #      #" +
    "#      # #   #   #      #" +
    "#      # #   #   #      #" +
    "#      #  # # # #       #" +
    "#      #  # # # #       #" +
    "#      #  # # # #       #" +
    "#      #   #   #        #" +
    "#      #   #   #        #" +
    "#                       #" +
    "# ### ### #   # ###     #" +
    "# #   # # #   # #       #" +
    "# ### ###  # #  ###  w  #" +
    "#   # # #  # #  #       #" +
    "# ### # #   #   ###     #" +
    "#                       #" +
    "#                       #" +
    "#%%%%%%%%%%%%%%%%%%%%%%%#",
    "#########################" +
    "#    uvv##>    #v+s #w###" +
    "#     --##  s  # 0# #WXX#" +
    "#       ## %%> # [#@XWWW#" +
    "#  = ^  #  V#  #  # XWWW#" +
    "#xxx %> #   # /#  # XWWW#" +
    "#    # [#% <# <e+<#@XXWW#" +
    "#   s# [##  # '% +# XWWW#" +
    "# %%%% <##  #  #  # XWWX#" +
    "# VVV#] ##} #  # <#@XWWW#" +
    "#   ~#> ##  #| #] # XWWW#" +
    "#    #} ## [#e]#- # XWWW#" +
    "#    #  ##  #  # <#@XXWW#" +
    "#  ^ #  ##  #  #+ # XWWW#" +
    "#^6x~# .##  #][#] # XWWW#" +
    "#%%% #  Vx 0#  # <#@XWWW#" +
    "#    #    /%#  s  # #WWW#" +
    "# p %#55  xxx  #  #  WWW#" +
    "#%%%%#%%%%%%%xxxxx#%%%%##",
    "#########################" +
    "#            u          #" +
    "#     uu   u   u   u    #" +
    "#psb u   u       u    ^ #" +
    "#%%dddddddcccdddddddCCC #" +
    "#  vVVV#VVXVVVVVVVVVVv  #" +
    "#         V             #" +
    "#                       #" + 
    "#  ^            5       #" +
    "#  X   u        X   ^ bs#" +
    "# s#jjjjjjjjjjjj#jjj#j%%#" +
    "# ######?################" +
    "# #w vVvWvVvW#U#   'PUUU#" +
    "# #zPPPP^PPPPPP^./# P   #" +
    "# #%%%%%%%%%%% %d##q qqs#" +
    "# P    @       P  #+u #_#" +
    "# P@          +## V   ! #" +
    "# P  @    |   +z | /%   #" +
    "#%%ccccCCCDDddc##%%%#%5%#",
   //1234567890123456789012345
    "%PPPPPPPPPPP##%%%%%%%XXX%" + //1
    "#            # +    '   #" + //2
    "#p s         Q + ^      #" + //3
    "#%-% 5    ^  #%  %PHP   #" + //4
    "gPPPW%  - % <#    hP%   #" + //5
    "#    #    #  #.H eeE#jjj#" + //6 
    "#   <# ++ #] #   ##s+vvvE" + //7
    "#.   #xxxx# [#H.H##____.E" + //8
    "#    # Vv XPP#P . e     E" + //9
    "#    v    #  #    eCCCCC#" + //10
    "#     5   #     sq      #" + //11
    "#ccccccccT#     %%%%%%%e#" + //12
    "#w#V +   ##555^##V#e    #" + //13
    "#W#  + s #Q====Qe  e    #" + //14
    "#PV <%%%P^        E     #" + //15
    "#P]  ### %%Qq%X%%%      #" + //16
    "#    ###                #" + //17
    "#    ###               ~#" + //18
    "#    P~#                #",  //19
    //1234567890123456789012345
    "%%%%%%%Q  Q%%v    V   %%%" + //1
    "#ps    1  E       ^   ###" + //2
    "#%%%%  1##E   ^>< V    ##" + //3
    "#7 '1> 1uuE   V   ^  a  #" + //4
    "#   1  1$ E   ^  <V     #" + //5
    "  ^ 1 <1  1e  V   v      " + //6 
    " /1[1  1- 1e  ^    +t s  " + //7
    "%%7 1  1 -1j{ xxxxx%%%%%%" + //8
    "#7 <1] 1~ 1e       ######" + //9
    "#   1 [1 ~1e  V     #####" + //10
    "#  <1^ 1~ 1e            #" + //11
    "#   #V 1- 1#  ^ ^ ^ ^   #" + //12
    "# ^P#  1~-1e  v v v v   #" + //13
    "#5% # ^1  1e  V   V     #" + //14
    "#%# # V1  1e_^_^_^_^_^  #" + //15
    "#   #  1++1#VVVVVVVVVV  #" + //16
    "#] [#   # + O           #" + //17
    "#> <#s   q+ O           #" + //18
    "#}w{#%%   #CC55555555555#",  //19
    //1234567890123456789012345
    "#######xxxxx#############" + //1
    "#p   sR+ VX  !     !  s #" + //2
    "#%WWW%%/   ]!  ! !   ## #" + //3
    "#     #_X= {  !!*! !!#  #" + //4
    "#  a  #] { ]!  ?!!   #  #" + //5
    "#     # _]<  !! ! !! # <#" + //6 
    "#A=;=â†# X }!    !    #  #" + //7
    "#       X <    !^^^^^#j #" + //8
    "#  â†‘^^  X }^w^^^####### #" + //9
    "#%%%??%%7 #######    #  #" + //10
    "#         sq   q e ^ P. P" + //11
    "# <##T###&##=# #   X]#!!#" + //12
    "#         #u # #_ <X P .P" + //13
    "#####T##X #  # #>  X #  #" + //14
    "##V v     # #> <]{ X P. P" + //15
    "#e ^  s##T7 X [>â­™ _X[#  #" + //16
    "#  {6_###  oX <] â­™^# P .P" + //17
    "#           X   ^6##   j#" + //18
    "#####T#####^#############",  //19
    
    
];
// levels[99] = "p        w";
var layers = [
    false,
    false,
    false,
    [
        {
            offset: [0, 16],
            tileset : 1, // 1:Normal, 2:Background, 3:Datalayer
                   //1234567890123456789012345
            map:    "666666666666             " + //1
                    "                         " + //2
                    "                         " + //3
                    "                   <     " + //4
                    "                         " + //5
                    "                  WWWWWWW" + //6
                    "                  WWWWWWW" + //7
                    "                  WWWWWWW" + //8
                    "               P  WWWWWWW" + //9
                    "                  WWWWWWW" + //10
                    "                  WWWWWWW" + //11
                    "                e        " + //12
                    "                         " + //13
                    "         #               " + //14
                    "                 #       " + //15
                    "              V          " + //16
                    "                      P  " + //17
                    "                         " + //18
                    "5555555555555555555555555",  //19
        }
    ],
    [
        {
            offset: [0, 16],
            tileset : 1, // 1:Normal, 2:Background, 3:Datalayer
                   //1234567890123456789012345
            map:    "       Q  Q   WWWWW      " + //1
                    "              WWWWW      " + //2
                    "              WWWWW      " + //3
                    "              WWWWW      " + //4
                    "              WWWWW      " + //5
                    "              WWWWW      " + //6
                    "      {       WWWWW      " + //7
                    "            ]            " + //8
                    " ] {                     " + //9
                    " >                       " + //10
                    "                         " + //11
                    " WWW                     " + //12
                    " WWW                     " + //13
                    " WWW                     " + //14
                    "                         " + //15
                    "        e                " + //16
                    "                         " + //17
                    "          e              " + //18
                    "       #  #              ",  //19
        }
    ],
    [
    {
            offset: [00, 16],
            tileset : 1, // 1:Normal, 2:Background, 3:Datalayer
                   //1234567890123456789012345
            map:    "                         " + //1
                    "                         " + //2
                    "                         " + //3
                    "                         " + //4
                    "                         " + //5
                    "                         " + //6
                    "                  !!!    " + //7
                    "                         " + //8
                    "                         " + //9
                    "                         " + //10
                    "                         " + //11
                    "                         " + //12
                    "                         " + //13
                    "                         " + //14
                    "          >  v           " + //15
                    "                         " + //16
                    "                         " + //17
                    "                         " + //18
                    "       ++++++            ",  //19
        },
        {
            offset: [00, 00],
            tileset : 3, // 1:Normal, 2:Background, 3:Datalayer
                   //1234567890123456789012345
            map:    "                    3    " + //1
                    "                         " + //2
                    "                         " + //3
                    "                         " + //4
                    "               3         " + //5
                    "                         " + //6
                    "                    #    " + //7
                    "                         " + //8
                    "                         " + //9
                    "                         " + //10
                    "q     Q                  " + //11
                    " $            %          " + //12
                    "                         " + //13
                    " 4                       " + //14
                    "                         " + //15
                    "                         " + //16
                    "                         " + //17
                    "                         " + //18
                    "              5          ",  //19
        },
        {
            offset: [0, 0],
            tileset : 2, // 1:Normal, 2:Background, 3:Datalayer
                   //1234567890123456789012345
            map:    "           ##            " + //1
                    "#########################" + //2
                    "#########################" + //3
                    "##   ####################" + //4
                    "##   ####################" + //5
                    "##   ####G###############" + //6
                    "##   ####G###############" + //7
                    "## t ####G###############" + //8
                    "##%%%####G#######      ##" + //9
                    "#########G###    ########" + //10
                    " GGGGGGGGGG##############" + //11
                    " GG        ############# " + //12
                    " GGGGGGGGG ##############" + //13
                    "         G GG########### " + //14
                    " #####GGGG GG############" + //15
                    " #####GG  GGG########### " + //16
                    " #####GGGGGGG############" + //17
                    " #####GGGGGGG########### " + //18
                    "           #             ",  //19
        },
    ]
];
var triggerList = [];

function loadLevel(number) {
    var data = levels[number],
        c, cx, cy;
    walls = [];
    saves = [];
    spikes = [];
    platforms = [];
    bullets = [];
    blood = [];
    blocker = [];
    fake = [];
    crates = [];
    backgrounds = [];
    triggerList = [];

    player = 0;
    warp = 0;

    if (number==3) {color = "#322d34";}
    if (number==4) {color = "#0000ff";}
    if (number==1) {color = "#d6cabe";}
    if (number==5) {color = "#749cdcff";}
    
    sndMusic.play();
    sndMusic.loop = true;
    sndMusic.volume = JSON.parse(localStorage.muted) ? 0 : 0.67;

    clearInput();
    sndDie.pause();
    // sndPain.pause();

    if (layers[number]){
        for (let index = 0; index < layers[number].length; index++) {
            const layer = layers[number][index];
            for (var i = 0; i < 25 * 19; i++) {
                tileset(layer.tileset,layer.map,i,layer.offset, index)
            }
        }
    }
    

    for (var i = 0; i < 25 * 19; i++) {
        tileset(1,data,i)
    }

    
    updateMarquee();
}

var walls, saves, spikes, player, fake, crates, backgrounds;
//#1egEqQ%?!+s~_-0=^z65xX7'/)|vVuU<>{}[].@aAbwWjTJcCdDhHoO8rRP$tp:
function tileset(number, data, i, offset = [0,0], index = 0) {
    c = data.charAt(i);
    cx = ((i % 25) * 32) + offset[0];
    cy = ((Math.floor(i / 25)) * 32) + offset[1];
    switch (number) {
        case 1:
            
            if (c == '#') walls.push(new Wall(cx, cy));
            if (c == '1') walls.push(new WallStick(cx, cy));
            if (c == 'e') walls.push(new Wall(cx-16, cy+00));
            if (c == 'g') {walls.push(new Wall(cx-32, cy+00)); spikes.push(new SpikeRight(cx, cy, 5));}
            if (c == 'E') walls.push(new Wall(cx+16, cy+00));
            if (c == 'q') walls.push(new Wall(cx-00, cy+16));
            if (c == 'Q') walls.push(new Wall(cx+00, cy-16));

            if (c == '%') walls.push(new Wall2(cx, cy));
            if (c == '?') fake.push(new WallI(cx, cy, false));
            if (c == '!') walls.push(new WallI(cx, cy));

            if (c == '+') blocker.push(new WallI(cx, cy, true, false));

            if (c == 's') saves.push(new Save(cx, cy));
            if (c == '~') platforms.push(new Platform(cx, cy, 2, 0));
            if (c == '_') platforms.push(new Platform(cx, cy+16, 0, 0));
            if (c == '-') platforms.push(new Platform(cx, cy, 0, 1));
            if (c == '0') platforms.push(new Platform(cx, cy, 0, 2));

            if (c == '=') platforms.push(new Platform(cx, cy, 0, 0));

            if (c == '^') spikes.push(new SpikeUp(cx, cy));
            if (c == 'z') {spikes.push(new SpikeUp(cx, cy+05)); fake.push(new WallI(cx, cy, false));}

            if (c == '6') spikes.push(new SpikeUp(cx, cy-16));
            if (c == '5') spikes.push(new SpikeUp(cx, cy+16));
            if (c == 'x'){ spikes.push(new SpikeUp(cx-16, cy));spikes.push(new SpikeDown(cx+1, cy));}
            if (c == 'X'){ spikes.push(new SpikeBlock(cx, cy));}
            if (c == '7'){ spikes.push(new SpikeDown(cx-16 , cy));}
            if (c == "'"){ spikes.push(new SpikeDown(cx+16 , cy));}

            if (c == '/'){ spikes.push(new SpikeUp(cx+16 , cy));}
            if (c == ')'){ spikes.push(new SpikeUp(cx+20 , cy));}

            if (c == '|'){ spikes.push(new SpikeUp(cx-16 , cy));}



            if (c == 'V') spikes.push(new SpikeDown(cx, cy));
            if (c == 'v') spikes.push(new SpikeDown(cx, cy-16));

            if (c == 'u') spikes.push(new SpikeDown(cx, cy, 2));
            if (c == 'U') {spikes.push(new SpikeDown(cx, cy-05));  fake.push(new WallI(cx, cy, false));}
            if (c == '&') {platforms.push(new Platform(cx, cy, 0, 0));  fake.push(new WallI(cx, cy, false));}


            if (c == '<') spikes.push(new SpikeLeft(cx, cy));
            if (c == '>') spikes.push(new SpikeRight(cx, cy));
            if (c == '{') spikes.push(new SpikeLeft(cx-16, cy));
            if (c == '}') spikes.push(new SpikeRight(cx+16, cy));
            if (c == '[') spikes.push(new SpikeLeft(cx+16, cy));
            if (c == ']') spikes.push(new SpikeRight(cx-16, cy));
            if (c == '.') spikes.push(new SpikeRight(cx, cy, 1));
            if (c == '@') spikes.push(new SpikeRight(cx, cy, Math.random()*3));



            if (c == 'b') blocker.push(new Blocker(cx, cy));
            if (c == 'w') warp = new Warp(cx, cy);
            if (c == 'W') fake.push(new Water(cx, cy));

            if (c == 'j') {fake.push(new Jumper(cx, cy, 15, sprJumpy)); blocker.push(new Blocker(cx, cy));}
            if (c == 'T') {fake.push(new Jumper(cx, cy+5, 15, sprJumpy)); fake.push(new WallI(cx, cy, false));}
            if (c == 'J') fake.push(new Jumper(cx, cy, 20, sprJumpest));

            if (c == 'c') walls.push(new Conveyer(cx, cy, 1));
            if (c == 'C') walls.push(new Conveyer(cx, cy, 4));

            if (c == 'd') walls.push(new Conveyer(cx, cy, -1));
            if (c == 'D') walls.push(new Conveyer(cx, cy, -4));

            // if (c == 'y') crates.push(new Crate(cx, cy, false, 25, 25));
            if (c == "H") platforms.push(new WallPlat(cx,cy,sprWall,1,0))
            if (c == "h") platforms.push(new WallPlat(cx,cy,sprWall,0,1))

            if (c == "o") platforms.push(new WallPlat(cx,cy,sprPauser,0,2))
            if (c == "O") platforms.push(new WallPlat(cx,cy,sprPauser,2,0))
            if (c == "8") platforms.push(new WallPlat(cx,cy,sprPauser,2,2))

            if (c == 'r') fake.push(new OneWayWall(cx, cy, false));
            if (c == 'R') fake.push(new OneWayWall(cx, cy, true));


            if (c == 'P') walls.push(new Poof(cx, cy));
            if (c == '$') walls.push(new Poof(cx, cy, 64, 64));
            if (c == 't') backgrounds.push(new Tree(cx, cy-135));

            
            if (c == 'a') spikes.push(new DeliciousFruit(cx, cy, 0, 10, index+1));
            if (c == '*') {fake.push(new Trigger(cx, cy, cx+cy));spikes.push(new DeliciousFruit(cx, 0, 0, 10, cx+cy));}
            if (c == 'â­™') spikes.push(new DeliciousFruit(cx, cy, 0, 0, 0));
            if (c == 'A') spikes.push(new DeliciousFruit(cx, cy, 10, 0, index+1));
            if (c == 'â†‘') spikes.push(new DeliciousFruit(cx, cy, 0, -10, index+1));
            if (c == 'â†') spikes.push(new DeliciousFruit(cx, cy, -10, 0, index+1));
            

            if (c == ';') fake.push(new Trigger(cx, cy, index+1));
            if (c == ':') fake.push(new Trigger(cx, cy, index+1, true));


            if (c == 'p') player = new Kid(cx, cy);
            
        break;
        case 2:
            switch (c) {
                case "#":
                    backgrounds.push(new Wall(cx,cy, 1))
                    break;
                case "3":
                    backgrounds.push(new Wall(cx,cy, 2))
                    break;

                case "%":
                    backgrounds.push(new Wall2(cx,cy, 1))
                    break;
                case "5":
                    backgrounds.push(new Wall2(cx,cy, 2))
                    break;

                case "G":
                    backgrounds.push(new Poof(cx,cy, 32, 32, 2))
                    break;

                case 't':
                    backgrounds.push(new Tree(cx, cy-135));
                    break;
            
                default:
                    break;
            }
        break;
        case 3:
            let cur = 2;
            if (c == '1') spikes.push(new DeliciousFruit(cx, cy, 0, 10, index+cur));
            if (c == '!') fake.push(new Trigger(cx, cy, index+cur));
            cur++;
            if (c == '2') spikes.push(new DeliciousFruit(cx, cy, 0, 10, index+cur));
            if (c == '@') fake.push(new Trigger(cx, cy, index+cur));
            cur++;
            if (c == '3') spikes.push(new DeliciousFruit(cx, cy, 0, 10, index+cur));
            if (c == '#') fake.push(new Trigger(cx, cy, index+cur));
            cur++;
            if (c == '4') spikes.push(new DeliciousFruit(cx, cy, 0, -10, index+cur));
            if (c == '$') fake.push(new Trigger(cx, cy, index+cur));
            cur++;
            if (c == '5') spikes.push(new DeliciousFruit(cx, cy, 0, -10, index+cur));
            if (c == '%') fake.push(new Trigger(cx, cy, index+cur));
            cur++;
            if (c == 'q') spikes.push(new DeliciousFruit(cx, cy, 10, 0, index+cur));
            if (c == 'Q') fake.push(new Trigger(cx, cy, index+cur));
            cur++;
            if (c == 'w') spikes.push(new DeliciousFruit(cx, cy, 10, 0, index+cur));
            if (c == 'W') fake.push(new Trigger(cx, cy, index+cur));
            cur++;
            if (c == 'e') spikes.push(new DeliciousFruit(cx, cy, 10, 0, index+cur));
            if (c == 'E') fake.push(new Trigger(cx, cy, index+cur));
            cur++;

            if (c == ':') fake.push(new Trigger(cx, cy, index+1, true));
        break;
        default:
            break;
    }
}
function getFuncName() {
   return getFuncName.caller.name
}

function Blocker(x, y) {
    this.definition = [getFuncName(),Array.from(arguments)];
    this.x = x;
    this.y = y;
    this.width = 32;
    this.height = 32;
}

function Warp(x, y) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 32;
    this.height = 32;
    this.render = function() {
        sprite(sprWarp, this.x, this.y)
    };
}
function Wall(x, y, background = 0) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 32;
    this.height = 32;

    this.render = function() {
        switch (level) {
            case 3:
                sprite(sprChecker, this.x, this.y)
                break;

            case 4:
            case 5:
                sprite(sprDirt, this.x, this.y)
                break;
        
            default:
                sprite(sprWall, this.x, this.y)
                break;
        }
        if(background == 3) sprite(sprDim, this.x, this.y);
        else if(background == 2) sprite(sprDark, this.x, this.y);
        else if(background == 1) sprite(sprDarker, this.x, this.y);

    };
}
function Text(x, y, text, fillStyle = "black", font = "bold 20px serif") {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 1;
    this.height = 1;

    this.render = function() {
        con2d.fillStyle = fillStyle;
        con2d.font = font
        con2d.fillText(text, this.x, this.y);
    };
}
function WallStick(x, y) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 32;
    this.height = 32;
    this.sticky = true;
    this.flash = false;

    this.render = function() {
        sprite(sprStick, this.x, this.y)
        if(this.flash){
            con2d.fillStyle = `rgba(255,0,0,${vkUp?0.5:0.1})`;
            con2d.fillRect(this.x,this.y,this.width,this.height);
            this.flash = false;
        }
    };

    this.collide = function(other){
        other.jump = 1;
        // other.djump = 0;
        this.flash = true;
        other.vsp = vkUp?0:Math.min(other.vsp, 1);
    };
}
function Trigger(x, y, layer, multiple = false) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 32;
    this.height = 32;
    this.layer = layer;
    this.timer = 5;

    this.render = function() {
        if(multiple && triggerList[layer]){
            if (--this.timer == 0){
                triggerList[layer] = false
            }
        }
        if(showTriggers){
            con2d.fillStyle = "rgba(255, 0, 0, 0.5)"
            con2d.fillRect(x,y, 32, 32) 
        }
        
        return;
    };

    this.collide = function(other){
        if(triggerList[layer] != true){
            triggerList[layer] = true;
            this.timer = 5;
            playSound(sndFruit);
        }
    };
}
function OneWayWall(x, y, direction) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 32;
    this.height = 32;
    this.direction = direction;
    this.oneway = true;

    this.render = function() {
        sprite(this.direction?sprHuh2:sprHuh, this.x, this.y)
    };

    this.collide = function(other){
        if( other.x > this.x + 25 && other.x < this.x + this.width && !this.direction){
            other.x = (this.x + this.width);
        }else if( other.x+other.width-7 < this.x && other.x+other.width > this.x && this.direction){
            other.x = this.x - other.width;
        }
    };
}
function WallPlat(x, y, spr = sprPanel, xv = 0, yv = 0) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 32;
    this.height = 32;
    this.sprite = spr;
    this.wallplat = true;
    this.pause = false;
    this.hsp = xv ;
    this.vsp = yv ;
    this.render = function() {
        sprite(this.sprite, this.x, this.y);
        // if(this.hsp || this.vsp){
        //     this.update()
        // }
    };
    this.platform = true;

    this.update = function() {
        with(this) {
            if(this.pause) return;
            coll = findWall(this, hsp, 0) || findWall(this,hsp,0,blocker);
            if (coll && coll != this) hsp = -hsp;
            x += hsp;

            coll = findWall(this, 0, vsp) || findWall(this,0,vsp,blocker);
            if (coll && coll != this) vsp = -vsp;
            y += vsp;

            if(y > 650) y = -40 ;
            if(y < -65) y = 640 ;
            if(x > 800) x = 0;
            if(x < 0) x = 800;
        }
    };
}
function Crate(x, y, breakable = false, width = 32, height = 32) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = width;
    this.height = height;
    this.render = function() {
        if (this.breakable){
            sprite_ext(sprJumpest, 0, 0, width, height, this.x, this.y)
        }else{
            sprite_ext(sprWall, 0, 0, width, height, this.x, this.y)
        }
    };
    this.collide = function(other){
        if (other.y < (this.y - (this.height/2))) return;
        this.hsp += other.hsp * 0.9
    }
    this.crate = true;
    this.breakable = breakable;
    this.ontop = null
    this.grav = 0.3;
    this.vsp = -2;
    this.hsp = 0;
    this.update = function() {
        with(this) {
            vsp += grav;
            let coll = findWall(this, 0, vsp, walls);
            // 1 is not a pixel. to do this, find the distance between the collision
            if (coll) {
                let dist
                if( Math.sign(vsp) > 0 ){
                    dist = (coll.y - coll.height) - (y + (height-32))
                }else{
                    dist = (y - (height + (height-32))) - (coll.y)
                }
                let coll3 = findWall(this, 0, dist, walls);
                vsp = coll3 ? 0 : dist;

             }
            let coll2 = findWall(this, hsp, 0, walls);
            if (coll2) {
                let dist
                if( Math.sign(hsp) > 0 ){
                    dist = (coll.x) - (x + (width-32));
                    // alert(dist)
                }else{
                    dist = (x + (width-32)) - (coll.x + coll.width);
                }
                let coll3 = findWall(this, dist, 0, walls) || findWall(this, dist, 0, fake);
                hsp = coll3 ? 0 : dist;
            }

            let coll4 = findWall(this, hsp, vsp, fake);
            if(coll4 && coll4.collide){
                coll4.collide(this);
            }

            onplatform = false;
            let s = platforms.concat(crates)
            for (var i = 0, l = s.length; i < l; i++) {
                coll = s[i];
                if (intersectRect(this, coll, 0, coll.vsp + 1) && coll != this) {
                    onplatform = true;
                    ontop = coll.ontop ? coll.ontop : coll;
                    x += coll.hsp;
                    coll2 = findWall(this, 0, 0);
                    if (coll2) {
                        if (x < coll2.x) x = coll2.x - width;
                        else x = coll2.x + coll2.width;
                    }
                    if (y + 12 - vsp / 2 <= coll.y) {
                        y = coll.y - height;
                        vsp = 0;
                    }
                }
            }
            if (!onplatform) ontop = null


            y += vsp;
            x += hsp;
            hsp = 0;      
        }
    };
}

function Wall2(x, y, background = 0) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 32;
    this.height = 32;
    this.render = function() {
        switch (level) {
            case 3:
                sprite(sprChecker2, this.x, this.y)
                break;

            case 4:
            case 5:
                sprite(sprGrass, this.x, this.y)
                break;
        
            default:
                sprite(sprWall2, this.x, this.y)
                break;
        }
        if(background == 3) sprite(sprDim, this.x, this.y);
        else if(background == 2) sprite(sprDark, this.x, this.y);
        else if(background == 1) sprite(sprDarker, this.x, this.y);
    };
}
function WallI(x, y, inv = true, doit = true) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 32;
    this.height = 32;
    this.invis = inv;
    this.collide = function(other ){
        if (!doit) return;
        if (this.invis == inv) {this.invis = !this.invis;playSound(sndChange);}
    };
    this.render = function(other) {
        if (!this.invis) {
            switch (level) {
                case 3:
                    sprite(sprChecker, this.x, this.y)
                    break;

                case 4:
                case 5:
                    sprite(sprDirt, this.x, this.y)
                    break;
            
                default:
                    sprite(sprWall, this.x, this.y)
                    break;
            }
        }
        //
    };
}
function Water(x, y) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 32;
    this.height = 32;
    this.collide = function(other){
        other.djump = 1;
        other.vsp = Math.min(other.vsp, 1);
    };
    this.render = function() {
       sprite(sprWater, this.x, this.y)
    };
}
function Jumper(x, y, power = 20, spriter = sprJumper) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 32;
    this.height = 32;
    this.spriter = spriter
    this.collide = function(other){
        if (!other.crate){
            other.djump = 1;
            other.vsp = -power;
        }else{
            other.vsp = -power/2;
        }
    };
    this.render = function() {
       sprite(this.spriter, this.x, this.y)
    };
}
function Tree(x, y) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 1;
    this.height = 1;
    this.render = function() {
       sprite(sprTree, this.x-32, this.y)
    };
}
function Conveyer(x, y, power = 20) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 32;
    this.height = 32;
    this.collide = function(other){
        other.x += power;
    };
    this.render = function() {
        
       sprite(power > 0 ? sprConveyer : sprConveyer2, this.x, this.y)
    };
}
function Poof(x, y, width = 32, height = 32, background = 0) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = width;
    this.height = height;
    this.collide = function(other){
        if (other.bullet){
            this.x = -50;
            this.y = -50;
            playSound(sndGlass)
        }
    };
    this.render = function() {
        sprite_ext(sprJumpest, 0, 0, 32, 32, this.x, this.y, width, height)
        if(background == 3) sprite(sprDim, this.x, this.y);
        else if(background == 2) sprite(sprDark, this.x, this.y);
        else if(background == 1) sprite(sprDarker, this.x, this.y);
    };
}

function SpikeUp(x, y) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 32;
    this.height = 32;
    this.spikedir = 1;
    this.render = function() {
        sprite(sprSpikeUp, this.x, this.y)
    };
    this.hitcheck = function(other) {
        this.width = 32;
        if (intersectRect(this, other, 0, 0)) {
            this.width = Math.floor((other.y + other.height - this.y) / 2 + 1) * 2;
            // con2d.fillStyle = "#00ff00"
            // con2d.fillRect(this.x,this.y,this.width,this.height)
            return intersectRect(this, other, 16 - this.width / 2, 0);
        }
        return 0;
    };
}
function SpikeBlock(x, y) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 32;
    this.height = 32;
    this.spikedir = 5;
    this.render = function() {
        sprite(sprKill, this.x, this.y)
    };
    this.hitcheck = function(other) {
        this.width = 32;
        if (intersectRect(this, other, 0, 0)) {
            // this.width = Math.floor((other.y + other.height - this.y) / 2 + 1) * 2;
            // con2d.fillStyle = "#00ff00"
            // con2d.fillRect(this.x,this.y,this.width,this.height)
            return true
        }
        return 0;
    };
}

function SpikeDown(x, y, vsp = 0) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 32;
    this.height = 32;
    this.vsp = vsp;
    this.spike = true;
    this.spikedir = 2;
    this.render = function() {
        sprite(sprSpikeDown, this.x, this.y)
    };
    this.hitcheck = function(other) {
        this.width = 32;
        if (intersectRect(this, other, 0, 0)) {
            this.width = Math.floor(16 - (other.y - this.y) / 2 + 1) * 2;
            return intersectRect(this, other, 16 - this.width / 2, 0);
        }
        return 0;
    };
    this.update = function() {
        if (vsp == 0) return;
        with(this) {
            coll = findWall(this, 0, vsp) || findWall(this,0,vsp,blocker);;
            if (coll) vsp = -vsp;
            y += vsp;
        }
    };
}

function SpikeLeft(x, y) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 32;
    this.height = 32;
    this.spike = true;
    this.spikedir = 3;

    this.render = function() {
        sprite(sprSpikeLeft, this.x, this.y)
    };
    this.hitcheck = function(other) {
        this.height = 32;
        if (intersectRect(this, other, 0, 0)) {
            this.height = Math.floor((other.x + other.width - this.x) / 2 + 1) * 2;
            return intersectRect(this, other, 0, 16 - this.height / 2);
        }
        return 0;
    };
}

function SpikeRight(x, y, hsp = 0, random = false) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 32;
    this.height = 32;
    this.hsp = hsp;
    this.spike = true;
    this.spikedir = 4;


    this.render = function() {
        sprite(sprSpikeRight, this.x, this.y)
    };
    this.hitcheck = function(other) {
        this.height = 32;
        if (intersectRect(this, other, 0, 0)) {
            this.height = Math.floor(16 - (other.x - this.x) / 2 + 1) * 2;
            return intersectRect(this, other, 0, 16 - this.height / 2);
        }
        return 0;
    };
    this.update = function() {
        if (this.hsp == 0) return;
        if (random) {this.hsp *= Math.random() + 0.5; this.hsp = Math.abs(this.hsp).clamp(0.5, 10) * Math.sign(this.hsp);}
        with(this) {
            coll = findWall(this, hsp, 0) || findWall(this,hsp,0,blocker);
            if (coll) hsp = -hsp;
            x += hsp;
        }
    };
}
function DeliciousFruit(x, y, hsp = 0, vsp = 0, layer = 0) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x+4;
    this.y = y+4;
    this.width = 24;
    this.height = 24;

    this.hsp = 0;
    this.vsp = 0;
    this.shsp = hsp;
    this.svsp = vsp;

    this.layer = layer;
    this.frame = 0;
    this.frspd = 0.10;
    this.frnum = 4;
    this.dead = 0;

    this.render = function() {
        if(!this.dead) sprite((this.frame > 2)?sprFruit:sprFruit2, this.x, this.y)
    };
    this.hitcheck = function(other) {
        this.height = 16;
        this.width = 16;
        //function intersectRect(r1, r2, offx, offy) 
        return intersectRect(this, other, 4, 4);
    };
    this.update = function() {
        this.frame = (this.frame + this.frspd) % this.frnum;
        if (!triggerList[layer]) return;
        with(this) {
            if (!dead){
                x += shsp;
                y += svsp;
                if(x > 800) dead = 1;
                if(x < 0) dead = 1;
            }
        }
        
    };
}

function findSpike(x,y,dir){
    switch (dir) {
        case 1:
            
            break;
    
        default:
            break;
    }
}


function Save(x, y) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 32;
    this.height = 32;
    this.render = function() {
        sprite_ext(sprSave, !!this.saved * 32, 0, 32, 32, this.x, this.y)
        con2d.fillStyle = `rgba(0,150,0,${this.saved/50})`;
        con2d.font = "bold 25px Arial"
        con2d.fillText("saved!", this.x-16, this.y);
    };
    this.saved = 0;
    this.update = function() {
        if (this.saved) this.saved--;
    };
}

function Blood(x, y, hsp, vsp) {
    
    this.x = x;
    this.y = y;
    this.width = 2;
    this.height = 2;
    this.render = function() {
        sprite_ext(sprBlood, this.frame, 0, 4, 4, this.x - 1, this.y - 1)
    };
    this.hsp = hsp;
    this.vsp = vsp;
    this.stuck = 0;
    this.frame = Math.floor(Math.random() * 3);
    this.grav = 0.1 + Math.random() * 0.2
    this.update = function() {
        with(this) if (!stuck) {
            vsp += grav;
            coll = findWall(this, hsp, vsp);
            if (coll && Math.random() > 0.5) stuck = 1;
            x += hsp;
            y += vsp;
        }
    };
}

function Platform(x, y, hsp, vsp = 0) {
    this.definition = [getFuncName(),Array.from(arguments)];

    this.x = x;
    this.y = y;
    this.width = 32;
    this.height = 16;
    this.render = function() {
        sprite(sprPlatform, this.x, this.y)
    };
    this.hsp = hsp ;
    this.vsp = vsp ;
    this.platform = true;

    this.update = function() {
        with(this) {
            coll = findWall(this, hsp, 0) || findWall(this,hsp,0,blocker);
            if (coll) hsp = -hsp;
            x += hsp;

            coll = findWall(this, 0, vsp) || findWall(this,0,vsp,blocker);
            if (coll) vsp = -vsp;
            y += vsp;
        }
    };
}

function Bullet(x, y, hsp) {
    this.x = x - 1;
    this.y = y - 1;
    this.width = 2;
    this.height = 2;
    this.render = function() {
        sprite_ext(sprBullet, this.frame * 4, 0, 4, 4, this.x - 1, this.y - 1)
    };
    this.hsp = hsp;
    this.bullet = true
    this.frame = 0;
    this.dead = 0;
    this.update = function() {
        with(this) {
            frame = !frame;
            x += hsp;
            coll = findWall(this, 0, 0);
            if (coll) {
                dead = 1;
                if (coll.collide) {coll.collide(this)}
            }
            coll = findWall(this, 0, 0, fake);
            if (coll && coll.oneway) {
                dead = 1;
            }
            for (var i = 0, l = blocker.length; i < l; i++) {
                coll = blocker[i];
                if (intersectRect(this, coll, 0, 0)) {
                    dead = 1;
                    break;
                }
            }
            for (var i = 0, l = platforms.length; i < l; i++) {
                coll = platforms[i];
                if (intersectRect(this, coll, 0, 0)) {
                    dead = 1;
                    if(coll.sprite == sprPauser){
                        coll.pause = !coll.pause;
                    }
                    break;
                }
            }
            for (var i = 0, l = saves.length; i < l; i++) {
                coll = saves[i];
                if (intersectRect(this, coll, 0, 0)) {
                    if (!coll.saved && !coll.nobullets) {
                        coll.saved = 50;
                        saveGame();
                    }
                    break;
                }
            }

        // if(y > 650) y = -50 ;
        if(x > 800) dead = 1;
        if(x < 0) dead = 1;
        }
    };
}

function Kid(x, y) {
    this.x = x + 16;
    this.y = y + 11;
    this.width = 11;
    this.height = 21;
    this.hsp = 0;
    this.vsp = 0;
    this.jump = 0;
    this.djump = 0;
    this.xscale = 1;
    this.sprite = sprPlayerIdle;
    this.frame = 0;
    this.frspd = 0;
    this.frnum = 0;
    this.uplk = 1;
    this.zlk = 0;
    this.dead = 0;
    this.onplatform = 0;
    this.render = function() {
        if (!this.dead) {
            if (this.xscale == -1) {
                con2d.save();
                con2d.translate(this.x * 2 + this.width, 0);
                con2d.scale(-1, 1);
            }
            sprite_ext(this.sprite, Math.floor(this.frame) * 32, 0, 32, 32, this.x - 17 + 5, this.y - 23 + 12)
            if (this.xscale == -1) {
                con2d.restore();
            }
        }else if(this.dead > 22 && level != 99){
            sprite(sprRestart, (800/2) - (sprRestart.width/2),(608/2) - (sprRestart.height/2))
            // con2d.fillStyle = "red"
            // con2d.fillRect((800/2) - (sprRestart.width/2),(608/2) - (sprRestart.height/2), sprRestart.width, sprRestart.height);
    
        }
        if(level == 99){
            con2d.fillStyle = "rgba(0, 255, 0, 0.5)"
            con2d.fillRect(Math.floor(mcx/32) * 32, Math.floor(mcy/32) * 32, 32, 32) 
        }
    };
    this.update = function() {
        var h = vkRight - vkLeft,
            coll;
        with(this) if (dead) {
            dead += 1
            if (dead < 20) {
                for (i = 0; i < 40; i += 1) {
                    var d = Math.floor(Math.random() * 36) * 10;
                    var s = Math.random() * 6;
                    blood.push(new Blood(x + 5, y + 12, Math.cos(d * degtorad) * s, -Math.sin(d * degtorad) * s))
                }
            }
        } else {
            if (h != 0) xscale = h;
            hsp = h * 3;
            x += hsp;
            coll = findWall(this, 0, 0) || findWall(this, 0, 0, platforms)
            if (coll && (!coll.platform || (coll.platform && coll.wallplat))) {
                if(!coll.wallplat || (coll.wallplat && intersectRect(this, coll, coll.hsp, coll.vsp)))
                if (x < coll.x) x = coll.x - width;
                else x = coll.x + coll.width;
                if (coll.collide) {
                    coll.collide(this);
                }
                hsp = 0;

            }
            coll = findWall(this, 0, 0, fake);
            if (coll && coll.collide) {
                coll.collide(this);
            }
            if (vkZ) {
                if (!zlk) {
                    zlk = 1
                    if (bullets.length < 3) {
                        playSound(sndShot);
                        bullets.push(new Bullet(x + 5, y + 10, xscale * 16))
                        coll = findWall(this, 0,0, saves);
                        if (coll && !coll.saved){
                            coll.saved = 50;
                            saveGame();
                        }
                    }
                }
            } else zlk = 0;
            if (vkUp) {
                if (!uplk) {
                    uplk = 1;
                    if (!jump || onplatform) {
                        jump = 1;
                        vsp = -8.5;
                        playSound(sndJump);
                    } else {
                        if (djump) {
                            djump = 0;
                            vsp = -7;
                            playSound(sndJump2);
                        }
                    }
                }
            } else {
                if (jump && uplk && vsp < 0) vsp *= 0.45
                uplk = 0;
            }

            if (jump) {
                vsp = Math.min(9.4, vsp + 0.4);
                y += vsp;
                if (vsp < 0) sprite = sprPlayerJump;
                else sprite = sprPlayerFall;
                frspd = 0.5;
                frnum = 2;
                coll = findWall(this, 0, 0) ;
                if (coll) {
                    if (y < coll.y && vsp >= 0) jump = 0;
                    else {y = coll.y + coll.height;
                        if (coll.collide) {
                    coll.collide(this)
                }
                    }
                    vsp = 0;
                    
                }
            }
            onplatform = 0;
            for (var i = 0, l = platforms.length; i < l; i++) {
                coll = platforms[i];
                if (intersectRect(this, coll, 0, coll.vsp + 1)) {
                    onplatform = 1;
                    if (coll.kill) kill()


                    if(!coll.pause) x += coll.hsp;
                    // if(coll.wallplat) y += coll.vsp;
                    coll2 = findWall(this, 0, 0, "just");
                    if (coll2) {
                        if (x < coll2.x) x = coll2.x - width;
                        else x = coll2.x + coll2.width;
                    }
                    
                    if ((y + 12 - vsp / 2 <= coll.y)) {
                        y = coll.y - height-1;
                        if (vsp >= 0) jump = 0;
                        vsp = 0;
                    }else if(intersectRect(this, coll, 0, 1 + coll.vsp)  &&  coll.vsp > 0 && findWall(this,0,1,"just") && coll.wallplat && !coll.pause){
                        kill()
                    }
                    if (findWall(this,0,-1,"just") && coll.wallplat && coll.vsp < 0) kill()
                    if (findWall(this ,0,1,"just") && coll.wallplat && coll.vsp > 0) kill()
                    if (findWall(this,1,0,"just") && coll.wallplat && coll.hsp > 0 && y-0.5 > coll.y && !coll.pause) kill()
                    if (findWall(this,-1,0,"just") && coll.wallplat && coll.hsp < 0 && y-0.5 > coll.y && !coll.pause) kill()
                    if (intersectRect(this,coll,0,-1) && coll.wallplat) {y = coll.y + coll.height; vsp = Math.max(0,coll.vsp)}
                    
                }
            }
            for (var i = 0, l = crates.length; i < l; i++) {
                coll = crates[i];
                if (coll.ontop){
                    if (intersectRect(this, coll, 0, 1 + coll.ontop.vsp) || (intersectRect(this, coll, coll.ontop.hsp, coll.ontop.vsp))) {
                            onplatform = 1;
                            x += coll.ontop.hsp;
                            // y += coll.ontop.vsp;
                    }
                }
            }
            if (!jump) {
                sprite = sprPlayerIdle;
                frspd = 0.2;
                frnum = 4;
                djump = 1;
                if (h != 0) {
                    sprite = sprPlayerRun;
                    frspd = 0.5;
                    frnum = 6;
                }
                coll = findWall(this, 0, 1);
                if (!coll) jump = 1;
                else {y = coll.y - height; if (coll.collide) {
                    coll.collide(this)
                }};
            }

            if (intersectRect(this, warp, 0, 0)) {
                if (level == levels.length - 1) {
                    finished = 1;
                } else {
                    loadLevel(++level);
                }
            }

            for (var i = 0, l = spikes.length; i < l; i++) {
                coll = spikes[i];
                if (coll.hitcheck(this)) {
                    kill()
                    break;
                }
            }

            if(y > 600) y = -25 ;
            if(y < -25) y = 600 ;
            if(x > 790) x = 0;
            if(x < 0) x = 790;

            frame = (frame + frspd) % frnum;
        }
    };
    this.kill = function(){
        deaths++;
        playSound(sndPain);
        playSound(sndDie);
        sndDie.volume = JSON.parse(localStorage.muted) ? 0 : 0.67;
        // sndDie.playbackRate = 1
        sndMusic.volume = 0;
        this.dead = 1;
    }
}

function startGame() {
    if (parseFloat(localStorage.saved)) {
        started = 1;
        time = parseFloat(localStorage.time);
        deaths = parseFloat(localStorage.deaths);
        level = parseFloat(localStorage.level);
        if(level == 99) levels[99] = "p w";
        loadGame();
    } else {
        resetGame();
        loadLevel(level = 1);
        saveGame();
        started = 1;
    }
}

function saveGame() {
    if (!player.dead) {
        localStorage.level = level;
        localStorage.x = player.x;
        localStorage.y = player.y;
        localStorage.xscale = player.xscale;
        localStorage.deaths = deaths;
        localStorage.time = time;
        localStorage.saved = 1;
    }
    if(level == 99){
        let worldData = {};
        [walls,fake,spikes,saves,platforms,blocker,backgrounds].forEach((groupContents, index)=>{
            let arrName = ["walls","fake","spikes","saves","platforms","blocker", "backgrounds"][index];
            if(worldData[arrName] == null) worldData[arrName] = [];
            groupContents.forEach(a => {
                worldData[arrName].push(a.definition);
            });
        })
        worldData.player = [player.x, player.y];
        worldData.warp = [warp.x, warp.y];

        localStorage.worldData = JSON.stringify(worldData, null, 2);
        localStorage.customPosition = JSON.stringify([player.x,player.y]);
    }
};
let firstload = true
function loadGame() {
    if (started) {
        level = parseFloat(localStorage.level);
        loadLevel(level);
        player.x = parseFloat(localStorage.x);
        player.y = parseFloat(localStorage.y);
        player.xscale = parseFloat(localStorage.xscale);
        if(firstload) sndMusic.currentTime = parseFloat(localStorage.musicTime);
        firstload = false;
        updateMarquee();

        if(level == 99){
            let worldData = JSON.parse(localStorage.worldData) || walls;
            // alert(localStorage.worldData)
            Object.keys(worldData).forEach(arrName => {
                if( arrName == "player" ){
                    player.x = worldData.player[0]; player.y = worldData.player[1];
                    return;
                }
                if (arrName == "warp" ){
                    warp.x = worldData.warp[0]; warp.y = worldData.warp[1];
                    return;
                }
                worldData[arrName].forEach((def)=>{
                    try {
                        window[arrName].push(eval("new "+ def[0]+`(${JSON.stringify(def[1]).slice(1,-1)})`))
                    } catch (error) {
                        alert(error)
                        alert("new "+ def[0]+`(${def[1].toString()})`)
                    }
                })
            });
        }
    }
    
};

function resetGame() {
    localStorage.saved = 0;
    loadLevel(level = 0);
    time = 0;
    deaths = 0;
    started = 0;
    finished = 0;
    updateMarquee();
};

function systemUpdate() {
    var i;
    readInput();
    if (!started) {
        con2d.fillStyle = "#80ffff";
        document.querySelector("body").style.backgroundColor = "#80ffff";
        con2d.fillRect(0, 0, 800, 608);
        // for (i = 0, l = walls.length; i < l; i++) walls[i].render();
        sprite(sprLogos,0,0)
        // warp.render();

    } else if (!finished) {
        time += 1;
        [].concat(spikes,crates,platforms,blood,saves).forEach(element => {
            if (element.update) element.update();
        });
        for (i = 0, l = bullets.length; i < l; i++) {
            bullets[i].update();
            if (bullets[i].dead) {
                bullets.splice(i, 1);
                i -= 1;
                l -= 1;
            }
        }
        player.update();
        if (!(time % 50)) updateMarquee();
        con2d.fillStyle = `${color}${motionblur?"0f":""}`;
        document.querySelector("body").style.backgroundColor = color;
        con2d.fillRect(0, 0, 800, 608);
        if (!motionblur && (level == 1)){
            for (i = 0; i < 608; i += 13) {
                sprite(sprBack, 96, i);
                sprite(sprBack, 144, i);
                sprite(sprBack, 576, i);
                sprite(sprBack, 624, i);
            }
        }
        if(!motionblur && level == 4){
            for (i = 0; i < 608; i += 256) {
                sprite(sprStars, 0,i);
                sprite(sprStars, 256,i);
                sprite(sprStars, 256*2,i);
                sprite(sprStars, 256*3,i);
            }
        }

         [].concat(backgrounds,spikes,crates,platforms,fake,walls,saves,blood,bullets).forEach(element => {
            if (element.render) element.render();
        });
        
        warp.render();
        player.render();

        if (level == 2) {
            con2d.fillStyle = "black";
            con2d.font = "bold 20px serif"
            con2d.fillText("<-shoot", 100, 500);
        }
        else if (level == 4) {
            con2d.fillStyle = "white";
            con2d.font = "bold 20px serif"
            con2d.fillText("<-shoot", 600, 550);
            con2d.fillText("sticky->",150, 50);
        }
        else if (level == 1) {
            con2d.fillStyle = "white";
            con2d.font = "bold 20px serif"
            con2d.fillText("<-warp", 700, 50);
        }else if (level == 5) {
            con2d.fillStyle = "white";
            con2d.font = "bold 20px serif"
            con2d.fillText("delicious ", 20, 130);
            con2d.fillText("fruit-> ", 45, 150);
        }
        con2d.fillStyle = "white";
        con2d.font = "bold 15px "
        con2d.fillText(`${player.djump} ${vkZ?"Z":""} ${vkUp?"^":""} ${vkLeft?"<":""} ${vkRight?">":""}`, (10), (20));

        if (finished) {
            alert("clear");
        }
    }
    clearInput();
}

function updateMarquee() {
    var min = Math.floor(time / 3000);
    var sec = Math.floor((time / 50) % 60);
    var str = "<br><br>";
    if (level) {
        str = "Level: " + (level) + "<br>Time: ";
        if (min < 10) str += "0";
        str += min + ":";
        if (sec < 10) str += "0";
        str += sec + " | Deaths: " + deaths + "<br>";
    }
    timer.innerHTML = str;
};

window.addEventListener('unload', function(event) {
    localStorage.musicTime = sndMusic.currentTime;
});

loadLevel(level = 0)

var interval = 20;
var expected = Date.now() + interval;
setTimeout(step, interval);

function step() {
    systemUpdate();
    // var dt = Date.now() - expected;
    // expected += interval;
    setTimeout(step, interval);
}
</script>
</div>
</body>
